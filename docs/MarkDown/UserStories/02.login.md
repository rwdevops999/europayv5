# Login (email address)

- [x] a valid email is needed.

If the user is not known in EP (Europay) by the password,

- [x] (INNER CHECK) An account is created as GUEST.
- [x] The user will be emailed an OTP (One-Time Password) code.
- [x] The user is passed to OTP login dialog (continue with OTP Login)

If the user is known in EP but is flagged as passwordless,

- [x] An OTP code will be emailed.
- [x] The user is passed to OTP login dialog (continue with OTP Login)

If the user is known in EP but not flagged as passwordless,

- [x] the user is requested to enter the password (continue with Password Login)

If an user is blocked (for some reason),

- [x] the user can't continue login.

## OTP Login.

- [x] The user is emailed an OTP code and an time window to enter this code.
- [x] (INNER CHECK) a job must be created for this OTP with status = RUNNING
- [x] (INNER CHECK) the job must be started in Inngest for this OTP
- [x] If the expiration value, mentioned, in the email is passed without useage, the OTP code is expired.
- [x] entering an OTP code, which is expired, is not allowed => NOTIFICATION (expiration).
- [x] if an already used OTP code is entered => NOTIFICATION (already used).
- [x] if an OTP code is entered faulty => NOTIFICATION (OTP code wrong).
- [x] The user gets 3 attempts. After that the account is blocked => NOTIFICATION (blocked).
- [x] After correct entry of OTP code, the user is logged in => USER PROFILE FILLED IN.
- [x] (INNER CHECK) the job must in Inngest is suspended for this OTP
- [x] (INNER CHECK) the job status is COMPLETED

## Password Login

- [x] The user is requested to enter the password.
- [x] if the password is wrong => NOTIFICATION (wrong password).
- [x] after 3 wrong attempts, the account is blocked => NOTIFICATION (blocked).
- [x] After correct entry of password, the user is logged in => USER PROFILE FILLED IN.
